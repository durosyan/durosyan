{"pageProps":{"postData":{"id":"rendering_markdown_code","contentHtml":"<p>In the process of making this blog, I had a whole bunch of markdown files I needed to render.</p>\n<p>In these markdown files, there are sometimes code snippets, which look boring without syntax highlighting.</p>\n<p>To make these look better I implemented this syntax highlighting library</p>\n<ul>\n<li>https://github.com/remarkjs/remark-rehype?tab=readme-ov-file#use</li>\n<li>https://github.com/wooorm/starry-night/tree/main/style</li>\n<li>https://github.com/Microflash/rehype-starry-night?tab=readme-ov-file#install</li>\n</ul>\n<p>How these are implemented here is demonstrated in the <a href=\"https://github.com/plausible-denial/plausible-denial/blob/main/lib/posts.js\">lib/posts/posts.js</a> file of the github repository for this site:</p>\n<div class=\"hl hl-js\"><div class=\"hl-header\"><div class=\"hl-language\"><span>js</span></div></div><pre id=\"MC43ODM1NTg4\" style=\"--hl-line-number-gutter-factor: 2\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">path</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>path<span class=\"pl-pds\">'</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">matter</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>gray-matter<span class=\"pl-pds\">'</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">rehypeStringify</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>rehype-stringify<span class=\"pl-pds\">'</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">remarkRehype</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>remark-rehype<span class=\"pl-pds\">'</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">rehypeStarryNight</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>@microflash/rehype-starry-night<span class=\"pl-pds\">\"</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">remarkParse</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>remark-parse<span class=\"pl-pds\">\"</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">7</span><span class=\"pl-k\">import</span> { <span class=\"pl-smi\">unified</span> } <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>unified<span class=\"pl-pds\">'</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">8</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">remarkInlineCodeLang</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>@microflash/rehype-starry-night/remark-inline-code-lang<span class=\"pl-pds\">\"</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">9</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">rehypeStarryNightInline</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>@microflash/rehype-starry-night/rehype-starry-night-inline<span class=\"pl-pds\">\"</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">10</span><span class=\"pl-k\">import</span> <span class=\"pl-smi\">fileManager</span> <span class=\"pl-k\">from</span> <span class=\"pl-s\"><span class=\"pl-pds\">'</span>./files<span class=\"pl-pds\">'</span></span>;</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">11</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">12</span><span class=\"pl-k\">export</span> <span class=\"pl-smi\">async</span> <span class=\"pl-k\">function</span> <span class=\"pl-en\">getPostData</span>(<span class=\"pl-smi\">id</span>) {</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">13</span>  <span class=\"pl-k\">const</span> <span class=\"pl-c1\">fullPath</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">path</span>.<span class=\"pl-c1\">join</span>(postsDirectory, <span class=\"pl-s\"><span class=\"pl-pds\">`</span><span class=\"pl-pse\"><span class=\"pl-s1\">${</span></span><span class=\"pl-s1\">id</span><span class=\"pl-pse\"><span class=\"pl-s1\">}</span></span>.md<span class=\"pl-pds\">`</span></span>);</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">14</span>  <span class=\"pl-k\">const</span> <span class=\"pl-c1\">fileContents</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">fileManager</span>.<span class=\"pl-en\">getFile</span>(fullPath);</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">15</span>  <span class=\"pl-k\">const</span> <span class=\"pl-c1\">matterResult</span> <span class=\"pl-k\">=</span> <span class=\"pl-en\">matter</span>(fileContents);</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">16</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">17</span>  <span class=\"pl-k\">const</span> <span class=\"pl-c1\">processedContent</span> <span class=\"pl-k\">=</span> <span class=\"pl-k\">await</span> <span class=\"pl-en\">unified</span>()</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">18</span>    .<span class=\"pl-en\">use</span>(remarkParse)</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">19</span>    .<span class=\"pl-en\">use</span>(remarkInlineCodeLang)</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">20</span>    .<span class=\"pl-en\">use</span>(remarkRehype, { allowDangerousHtml<span class=\"pl-k\">:</span> <span class=\"pl-c1\">true</span> })</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">21</span>    .<span class=\"pl-en\">use</span>(rehypeStarryNight)</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">22</span>    .<span class=\"pl-en\">use</span>(rehypeStarryNightInline)</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">23</span>    .<span class=\"pl-en\">use</span>(rehypeStringify, { allowDangerousHtml<span class=\"pl-k\">:</span> <span class=\"pl-c1\">true</span> })</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">24</span>    .<span class=\"pl-en\">process</span>(<span class=\"pl-smi\">matterResult</span>.<span class=\"pl-c1\">content</span>);</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">25</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">26</span>  <span class=\"pl-k\">const</span> <span class=\"pl-c1\">contentHtml</span> <span class=\"pl-k\">=</span> <span class=\"pl-smi\">processedContent</span>.<span class=\"pl-c1\">toString</span>();</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">27</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">28</span>  <span class=\"pl-k\">return</span> {</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">29</span>    id,</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">30</span>    contentHtml,</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">31</span>    <span class=\"pl-k\">...</span><span class=\"pl-smi\">matterResult</span>.<span class=\"pl-c1\">data</span>,</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">32</span>  };</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">33</span>}</span>\n</code></pre></div>\n<p>Just an fyi, I used this colour scheme for the overall site design: <a href=\"https://gist.github.com/brayevalerien/cb94ac685ebc186f359deae113b6710c\">monokai</a></p>","title":"Rendering markdown code","date":"2025-01-20","tags":"markdown, code, snippets, tinkering"}},"__N_SSG":true}