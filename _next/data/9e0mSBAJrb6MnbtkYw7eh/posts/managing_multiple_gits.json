{"pageProps":{"postData":{"id":"managing_multiple_gits","contentHtml":"<p>I had several folders without initialized Git repositories that I needed to upload to GitHub. To automate this process, I used the following script to set up and push all the repositories to their remote origins.</p>\n<p>Note: I used a separate script to create all the remote repositories on GitHub.</p>\n<p>This process was quick and efficient with the help of AI.</p>\n<div class=\"hl hl-sh\"><div class=\"hl-header\"><div class=\"hl-language\"><span>sh</span></div></div><pre id=\"MC41OTk3MDE4\" style=\"--hl-line-number-gutter-factor: 2\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span><span class=\"pl-c\">#!/bin/sh</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span><span class=\"pl-c\"># Replace these variables with your own values</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span>OWNER=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>...<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span>TOKEN=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>...<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">7</span><span class=\"pl-c\"># Define color codes</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">8</span>GREEN=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>\\033[0;32m<span class=\"pl-pds\">'</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">9</span>RED=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>\\033[0;31m<span class=\"pl-pds\">'</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">10</span>YELLOW=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>\\033[1;33m<span class=\"pl-pds\">'</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">11</span>BLUE=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>\\033[0;34m<span class=\"pl-pds\">'</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">12</span>NC=<span class=\"pl-s\"><span class=\"pl-pds\">'</span>\\033[0m<span class=\"pl-pds\">'</span></span> <span class=\"pl-c\"># No Color</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">13</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">14</span><span class=\"pl-c\"># Get all repositories for the user</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">15</span>repos=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>curl -s -H <span class=\"pl-pds\">\"</span>Authorization: token <span class=\"pl-smi\">$TOKEN</span><span class=\"pl-pds\">\"</span> \\</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">16</span><span class=\"pl-s\">-H <span class=\"pl-pds\">\"</span>Accept: application/vnd.github.v3+json<span class=\"pl-pds\">\"</span> \\</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">17</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://api.github.com/user/repos?per_page=100<span class=\"pl-pds\">\"</span> <span class=\"pl-k\">|</span> jq -r <span class=\"pl-pds\">'</span>.[].name<span class=\"pl-pds\">')</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">18</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">19</span><span class=\"pl-c\"># Loop through each repository and get the SSH remote URL</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">20</span><span class=\"pl-k\">for</span> <span class=\"pl-smi\">REPO</span> <span class=\"pl-k\">in</span> <span class=\"pl-smi\">$repos</span><span class=\"pl-k\">;</span> <span class=\"pl-k\">do</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">21</span>    <span class=\"pl-c\"># GitHub API URL</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">22</span>    URL=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>https://api.github.com/repos/<span class=\"pl-smi\">$OWNER</span>/<span class=\"pl-smi\">$REPO</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">23</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">24</span>    <span class=\"pl-c\"># Get the repository details</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">25</span>    ssh_url=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>curl -s -H <span class=\"pl-pds\">\"</span>Authorization: token <span class=\"pl-smi\">$TOKEN</span><span class=\"pl-pds\">\"</span> \\</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">26</span><span class=\"pl-s\">    -H <span class=\"pl-pds\">\"</span>Accept: application/vnd.github.v3+json<span class=\"pl-pds\">\"</span> \\</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">27</span><span class=\"pl-s\">    <span class=\"pl-smi\">$URL</span> <span class=\"pl-k\">|</span> jq -r <span class=\"pl-pds\">'</span>.ssh_url<span class=\"pl-pds\">')</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">28</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">29</span>    <span class=\"pl-k\">if</span> [ <span class=\"pl-k\">-n</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$ssh_url</span><span class=\"pl-pds\">\"</span></span> ]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">30</span>        <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${BLUE}</span>Repository '<span class=\"pl-smi\">$REPO</span>' SSH URL: <span class=\"pl-smi\">$ssh_url${NC}</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">31</span>    <span class=\"pl-k\">else</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">32</span>        <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${RED}</span>Failed to get SSH URL for repository '<span class=\"pl-smi\">$REPO</span>'<span class=\"pl-smi\">${NC}</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">33</span>    <span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">34</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">35</span>    <span class=\"pl-c\"># Find the repository in the folder structure based on the repo name</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">36</span>    repo_path=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>find /Volumes/Extreme<span class=\"pl-cce\">\\ </span>SSD/Projects -type d -name <span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$REPO</span><span class=\"pl-pds\">\"</span> <span class=\"pl-k\">2></span>/dev/null<span class=\"pl-pds\">)</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">37</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">38</span>    <span class=\"pl-k\">if</span> [ <span class=\"pl-k\">-n</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$repo_path</span><span class=\"pl-pds\">\"</span></span> ]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">39</span>        <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${GREEN}</span>Found repository '<span class=\"pl-smi\">$REPO</span>' at path: <span class=\"pl-smi\">$repo_path${NC}</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">40</span>    <span class=\"pl-k\">else</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">41</span>        <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${YELLOW}</span>Repository '<span class=\"pl-smi\">$REPO</span>' not found in the folder structure<span class=\"pl-smi\">${NC}</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">42</span>    <span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">43</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">44</span>    <span class=\"pl-k\">if</span> [ <span class=\"pl-k\">-n</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$repo_path</span><span class=\"pl-pds\">\"</span></span> ]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">45</span>        <span class=\"pl-c1\">cd</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$repo_path</span><span class=\"pl-pds\">\"</span></span> <span class=\"pl-k\">||</span> <span class=\"pl-k\">continue</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">46</span>        git remote set-url origin <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$ssh_url</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">47</span>        <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span><span class=\"pl-smi\">${GREEN}</span>Updated remote URL for repository '<span class=\"pl-smi\">$REPO</span>' to '<span class=\"pl-smi\">$ssh_url</span>'<span class=\"pl-smi\">${NC}</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">48</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">49</span>        <span class=\"pl-c\"># Add all files and commit them</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">50</span>        git add -A</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">51</span>        git commit -m <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>init<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">52</span>        git branch -M main</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">53</span>        git push -u origin main</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">54</span>    <span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">55</span><span class=\"pl-k\">done</span></span>\n</code></pre></div>","title":"Managing Multiple Git Repositories","date":"2025-01-15","tags":"engineering, tinkering, snippets"}},"__N_SSG":true}