{"pageProps":{"postData":{"id":"llm_tagging_system_20250115","contentHtml":"<p>I designed this script to be able to quickly create and semantically tag blog content from the command line.</p>\n<p>The content itself is not ai generated, only the tags.</p>\n<p>Usage:</p>\n<div class=\"hl hl-bash\"><div class=\"hl-header\"><div class=\"hl-language\"><span>bash</span></div></div><pre id=\"MC44NDM5MDM1\"><code tabindex=\"0\"><span class=\"line\">./new_entry.sh <span class=\"pl-s\"><span class=\"pl-pds\">'</span>blog title<span class=\"pl-pds\">'</span></span></span>\n</code></pre></div>\n<p>Script:</p>\n<div class=\"hl hl-bash\"><div class=\"hl-header\"><div class=\"hl-language\"><span>bash</span></div></div><pre id=\"MC43ODQwNDA3\" style=\"--hl-line-number-gutter-factor: 2\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span><span class=\"pl-c\">#!/bin/bash</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span><span class=\"pl-k\">if</span> [[ <span class=\"pl-smi\">$#</span> <span class=\"pl-k\">-gt</span> 1 ]]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span>    <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Error: Title should be a single argument. If it contains spaces, enclose it in quotes.<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span>    <span class=\"pl-c1\">exit</span> 1</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span><span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">7</span><span class=\"pl-k\">if</span> [[ <span class=\"pl-k\">-z</span> <span class=\"pl-smi\">$1</span> ]]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">8</span>    <span class=\"pl-c1\">read</span> -p <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Enter the title of your journal entry: <span class=\"pl-pds\">\"</span></span> title</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">9</span><span class=\"pl-k\">else</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">10</span>    title=<span class=\"pl-smi\">$1</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">11</span><span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">12</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">13</span><span class=\"pl-k\">if</span> [[ <span class=\"pl-k\">-f</span> .env ]]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">14</span>    <span class=\"pl-k\">export</span> <span class=\"pl-s\"><span class=\"pl-pds\">$(</span>grep -v <span class=\"pl-pds\">'</span>^#<span class=\"pl-pds\">'</span> .env <span class=\"pl-k\">|</span> xargs<span class=\"pl-pds\">)</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">15</span><span class=\"pl-k\">else</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">16</span>    <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>.env file not found. Exiting...<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">17</span>    <span class=\"pl-c1\">exit</span> 1</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">18</span><span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">19</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">20</span><span class=\"pl-k\">if</span> [[ <span class=\"pl-k\">-z</span> <span class=\"pl-smi\">$OPEN_AI_KEY</span> ]]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">21</span>    <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>OPEN_AI_KEY is not set in the .env file. Exiting...<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">22</span>    <span class=\"pl-c1\">exit</span> 1</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">23</span><span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">24</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">25</span>ai_prompt=<span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Create a series of topic tags from the following title, reply with only the comma separated tags in the format 'tag, tag, tag' no additional information or text, at least one of these tags must be used (Ai, Analysis, Economy, Engineering, Hacking, Philosophy, Research, Snippets, Tinkering). The title is: <span class=\"pl-pds\">\"</span></span><span class=\"pl-smi\">$title</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">26</span>response=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>curl https://api.openai.com/v1/chat/completions \\</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">27</span><span class=\"pl-s\">-H <span class=\"pl-pds\">\"</span>Content-Type: application/json<span class=\"pl-pds\">\"</span> \\</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">28</span><span class=\"pl-s\">-H <span class=\"pl-pds\">\"</span>Authorization: Bearer <span class=\"pl-smi\">$OPEN_AI_KEY</span><span class=\"pl-pds\">\"</span> \\</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">29</span><span class=\"pl-s\">-d <span class=\"pl-pds\">'</span>{</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">30</span><span class=\"pl-s\">    \"model\": \"gpt-4o\",</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">31</span><span class=\"pl-s\">    \"store\": true,</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">32</span><span class=\"pl-s\">    \"messages\": [</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">33</span><span class=\"pl-s\">        {\"role\": \"user\", \"content\": \"<span class=\"pl-pds\">'\"</span><span class=\"pl-smi\">$ai_prompt</span><span class=\"pl-pds\">\"'</span>\"}</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">34</span><span class=\"pl-s\">    ]</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">35</span><span class=\"pl-s\">    }<span class=\"pl-pds\">'</span> <span class=\"pl-k\">|</span> jq -r <span class=\"pl-pds\">'</span>.choices[0].message.content<span class=\"pl-pds\">')</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">36</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">37</span><span class=\"pl-k\">if</span> [[ <span class=\"pl-k\">-z</span> <span class=\"pl-smi\">$response</span> ]]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">38</span>    <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Error calling openai. Exiting...<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">39</span>    <span class=\"pl-c1\">exit</span> 1</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">40</span><span class=\"pl-k\">fi</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">41</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">42</span><span class=\"pl-c\"># Parse tags from the response of the AI (lowercase all, tags are separated by commas)</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">43</span>tags=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>echo <span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$response</span><span class=\"pl-pds\">\"</span> <span class=\"pl-k\">|</span> tr <span class=\"pl-pds\">'</span>[:upper:]<span class=\"pl-pds\">'</span> <span class=\"pl-pds\">'</span>[:lower:]<span class=\"pl-pds\">'</span> <span class=\"pl-k\">|</span> tr -d <span class=\"pl-pds\">'</span>\\\"<span class=\"pl-pds\">'</span> <span class=\"pl-k\">|</span> tr -d <span class=\"pl-pds\">\"</span>'<span class=\"pl-pds\">\")</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">44</span><span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Tags: <span class=\"pl-smi\">$tags</span><span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">45</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">46</span><span class=\"pl-k\">if</span> [[ <span class=\"pl-k\">!</span> <span class=\"pl-k\">-z</span> <span class=\"pl-smi\">$title</span> ]]<span class=\"pl-k\">;</span> <span class=\"pl-k\">then</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">47</span>    filetitle=<span class=\"pl-s\"><span class=\"pl-pds\">$(</span>echo <span class=\"pl-pds\">\"</span><span class=\"pl-smi\">$title</span><span class=\"pl-pds\">\"</span> <span class=\"pl-k\">|</span> tr <span class=\"pl-pds\">'</span>[:upper:]<span class=\"pl-pds\">'</span> <span class=\"pl-pds\">'</span>[:lower:]<span class=\"pl-pds\">'</span> <span class=\"pl-k\">|</span> tr <span class=\"pl-pds\">'</span> <span class=\"pl-pds\">'</span> <span class=\"pl-pds\">'</span>_<span class=\"pl-pds\">')</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">48</span>    filename=<span class=\"pl-smi\">$filetitle</span><span class=\"pl-s\"><span class=\"pl-pds\">\"</span>_<span class=\"pl-pds\">$(</span>date +%Y%m%d<span class=\"pl-pds\">)\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">49</span>    cat <span class=\"pl-s\"><span class=\"pl-k\">&#x3C;&#x3C;</span> <span class=\"pl-k\">EOF</span> > <span class=\"pl-smi\">$filename</span>.md</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">50</span><span class=\"pl-s\">---</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">51</span><span class=\"pl-s\">title: '<span class=\"pl-smi\">$title</span>'</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">52</span><span class=\"pl-s\">date: '<span class=\"pl-pds\">$(</span>date +<span class=\"pl-pds\">\"</span>%Y-%m-%d<span class=\"pl-pds\">\")</span>'</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">53</span><span class=\"pl-s\">tags: '<span class=\"pl-smi\">$tags</span>'</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">54</span><span class=\"pl-s\">---</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">55</span><span class=\"pl-s\"><span class=\"pl-k\">EOF</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">56</span>    <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>Created new blog entry: <span class=\"pl-smi\">$filename</span>.md<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">57</span><span class=\"pl-k\">else</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">58</span>    <span class=\"pl-c1\">echo</span> <span class=\"pl-s\"><span class=\"pl-pds\">\"</span>No title entered. Exiting...<span class=\"pl-pds\">\"</span></span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">59</span>    <span class=\"pl-c1\">exit</span> 1</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">60</span><span class=\"pl-k\">fi</span></span>\n</code></pre></div>","title":"llm tagging system","date":"2025-01-15","tags":["ai","snippets","research"]}},"__N_SSG":true}