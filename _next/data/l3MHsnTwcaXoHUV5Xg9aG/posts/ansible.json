{"pageProps":{"postData":{"id":"ansible","contentHtml":"<p>I'm trying to determine my favourite first touch and hardening setup for windows and debian.</p>\n<ol>\n<li><strong>Enable or Disable Windows Firewall Profiles</strong>:</li>\n</ol>\n<ul>\n<li>\n<p>You can use the <code>community.windows.win_firewall</code> module to enable or disable Windows Firewall profiles. This module allows you to control the state of the firewall for specific profiles (e.g., Domain, Private, Public). Here are some examples:</p>\n</li>\n<li>\n<p>To enable the firewall for Domain, Public, and Private profiles:</p>\n</li>\n</ul>\n<div class=\"hl hl-yaml\"><div class=\"hl-header\"><div class=\"hl-language\"><span>yaml</span></div></div><pre id=\"MC41MDkzNzI1\" style=\"--hl-line-number-gutter-factor: 1\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span>- <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Enable firewall for Domain, Public, and Private profiles</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span>  <span class=\"pl-ent\">community.windows.win_firewall</span>:</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span>    <span class=\"pl-ent\">state</span>: <span class=\"pl-s\">enabled</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span>    <span class=\"pl-ent\">profiles</span>:</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span>      - <span class=\"pl-s\">Domain</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span>      - <span class=\"pl-s\">Private</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">7</span>      - <span class=\"pl-s\">Public</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">8</span>  <span class=\"pl-ent\">tags</span>: <span class=\"pl-s\">enable_firewall</span></span>\n</code></pre></div>\n<ul>\n<li>To disable the Domain firewall:</li>\n</ul>\n<div class=\"hl hl-yaml\"><div class=\"hl-header\"><div class=\"hl-language\"><span>yaml</span></div></div><pre id=\"MC4yODc1MjA5\" style=\"--hl-line-number-gutter-factor: 1\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span>- <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Disable Domain firewall</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span>  <span class=\"pl-ent\">community.windows.win_firewall</span>:</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span>    <span class=\"pl-ent\">state</span>: <span class=\"pl-s\">disabled</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span>    <span class=\"pl-ent\">profiles</span>:</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span>      - <span class=\"pl-s\">Domain</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span>  <span class=\"pl-ent\">tags</span>: <span class=\"pl-s\">disable_firewall</span></span>\n</code></pre></div>\n<ul>\n<li>To enable the firewall for the Domain profile and block outbound connections:</li>\n</ul>\n<div class=\"hl hl-yaml\"><div class=\"hl-header\"><div class=\"hl-language\"><span>yaml</span></div></div><pre id=\"MC43Nzk5OTI5\" style=\"--hl-line-number-gutter-factor: 1\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span>- <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Enable firewall for Domain profile and block outbound connections</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span>  <span class=\"pl-ent\">community.windows.win_firewall</span>:</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span>    <span class=\"pl-ent\">profiles</span>: <span class=\"pl-s\">Domain</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span>    <span class=\"pl-ent\">state</span>: <span class=\"pl-s\">enabled</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span>    <span class=\"pl-ent\">outbound_action</span>: <span class=\"pl-s\">block</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span>  <span class=\"pl-ent\">tags</span>: <span class=\"pl-s\">block_connection</span></span>\n</code></pre></div>\n<ol start=\"2\">\n<li><strong>Deploy Specific Firewall Rules</strong>:</li>\n</ol>\n<ul>\n<li>\n<p>If you need more granular control, you can use the <code>community.windows.win_firewall_rule</code> module to create, remove, or update specific firewall rules. For example:</p>\n</li>\n<li>\n<p>To allow SMTP traffic on TCP port 25:</p>\n</li>\n</ul>\n<div class=\"hl hl-yaml\"><div class=\"hl-header\"><div class=\"hl-language\"><span>yaml</span></div></div><pre id=\"MC43MTYzOTUx\" style=\"--hl-line-number-gutter-factor: 1\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span>- <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Firewall rule to allow SMTP on TCP port 25</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span>  <span class=\"pl-ent\">community.windows.win_firewall_rule</span>:</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span>    <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">SMTP</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span>    <span class=\"pl-ent\">localport</span>: <span class=\"pl-c1\">25</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span>    <span class=\"pl-ent\">action</span>: <span class=\"pl-s\">allow</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span>    <span class=\"pl-ent\">direction</span>: <span class=\"pl-s\">in</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">7</span>    <span class=\"pl-ent\">protocol</span>: <span class=\"pl-s\">tcp</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">8</span>    <span class=\"pl-ent\">state</span>: <span class=\"pl-s\">present</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">9</span>    <span class=\"pl-ent\">enabled</span>: <span class=\"pl-s\">yes</span></span>\n</code></pre></div>\n<ul>\n<li>To allow RDP (Remote Desktop) on TCP port 3389:</li>\n</ul>\n<div class=\"hl hl-yaml\"><div class=\"hl-header\"><div class=\"hl-language\"><span>yaml</span></div></div><pre id=\"MC4wMTgyMDAy\" style=\"--hl-line-number-gutter-factor: 1\"><code tabindex=\"0\"><span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">1</span>- <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Firewall rule to allow RDP on TCP port 3389</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">2</span>  <span class=\"pl-ent\">community.windows.win_firewall_rule</span>:</span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">3</span>    <span class=\"pl-ent\">name</span>: <span class=\"pl-s\">Remote Desktop</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">4</span>    <span class=\"pl-ent\">localport</span>: <span class=\"pl-c1\">3389</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">5</span>    <span class=\"pl-ent\">action</span>: <span class=\"pl-s\">allow</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">6</span>    <span class=\"pl-ent\">direction</span>: <span class=\"pl-s\">in</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">7</span>    <span class=\"pl-ent\">protocol</span>: <span class=\"pl-s\">tcp</span></span>\n<span class=\"line\"><span class=\"line-number\" aria-hidden=\"true\">8</span>    <span class=\"pl-ent\">state</span>: <span class=\"pl-s\">present</span></span>\n</code></pre></div>","title":"Ansible first touch hardening","date":"2025-01-15","tags":["engineering","security","automation","tinkering"]}},"__N_SSG":true}